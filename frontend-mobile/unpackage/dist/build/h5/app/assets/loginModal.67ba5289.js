import{_ as t,a as e,u as s,o as i,B as o,w as a,b as d,c as l,d as n,e as w,t as c,f as r,I as u,r as m,q as h}from"./index-737b53c3.js";import{r as p,_ as x}from"./uni-popup.5b1a2d94.js";import{I as f}from"./iconify.5a6252cb.js";import{I as g}from"./IconFont.01846b5a.js";const b=t({components:{IconFont:g,Icon:f},data:()=>({isWechat:!1,page:"phone",phone:"",code:"",nextSMSCodeDuration:0,ticker:null}),computed:{currentTimestamp:()=>Math.round((new Date).getTime()/1e3),codeButtonText(){return this.nextSMSCodeDuration>0?`下次获取时间 ${this.nextSMSCodeDuration} s`:"获取验证码"},codeButtonDisabled(){return 11!==this.phone.length||this.nextSMSCodeDuration>0},loginButtonDisabled(){return 6!==this.code.length}},created(){this.ticker=setInterval((()=>{this.nextSMSCodeDuration>0&&this.nextSMSCodeDuration--}),1e3)},destroyed(){clearInterval(this.ticker)},methods:{show(){this.$refs.moduleConfig.open("bottom")},hide(){this.$refs.moduleConfig.close()},isPage(t){return this.page===t},switchPage(t){this.page=t},async getCode(){await e.SendSMSCode(this.phone),this.nextSMSCodeDuration=10,this.switchPage("code")},async login(){const t=await e.Login(this.phone,this.code);this.comsumeLoginRes(t)},async loginByWeixinPhone(t){const s=await e.LoginByWeixinPhone(t.detail.code);this.comsumeLoginRes(s)},comsumeLoginRes(t){const{commitJWT:e}=s(),{commitMe:i}=s();e(t.access_token),i(t),this.hide()}}},[["render",function(t,e,s,f,g,b){const v=r,y=u,C=m("IconFont"),S=p(h("uni-popup"),x);return i(),o(S,{ref:"moduleConfig"},{default:a((()=>[d("div",{style:{background:"linear-gradient(180deg, #252525 0%, #181818 100%)"},class:"tw-rounded-t-lg tw-text-white tw-overflow-hidden"},[d("div",{class:"tw-relative tw-p-3 tw-text-center tw-text-base"},[d("div",null,"快捷登录"),d("div",{class:"tw-absolute tw-top-0 tw-right-3"},[d("div",{class:"tw-relative tw-flex tw-flex-row tw-items-center tw-py-3 tw-opacity-60"},[d("div",{onClick:e[0]||(e[0]=(...t)=>b.hide&&b.hide(...t)),class:"tw-flex tw-items-center tw-justify-center tw-w-4 tw-h-4 tw-bg-white tw-bg-opacity-10 tw-rounded-full tw-p-0.5"},[d("img",{class:"tw-w-3 tw-h-3",src:"https://static.xxxxxx.com/63d2ad6ca4076d87299a85e2373bb5ad53a73ab1857c51c33930790f5cb3090e"})])])])]),b.isPage("phone")?(i(),l("div",{key:0},[d("div",{class:"tw-px-5 tw-pt-5 tw-pb-16"},[d("div",{class:"tw-relative"},[d("div",{class:"tw-text-xl"},"欢迎来到xxxx_xxx"),d("div",{class:"tw-text-white tw-mt-2 tw-text-opacity-50"},"每个人都值得被看见"),d("div",{class:"tw-m-6"}),g.isWechat?(i(),l("div",{key:0},[n(v,{"open-type":"getPhoneNumber",onGetphonenumber:b.loginByWeixinPhone,class:"tw-rounded-full"},{default:a((()=>[d("div",{class:"tw-h-12 tw-flex tw-items-center tw-text-center tw-justify-center tw-text-md"}," 手机号一键登录 ")])),_:1},8,["onGetphonenumber"]),d("div",{class:"tw-text-center tw-text-white tw-text-opacity-50 tw-mt-3 tw-text-sm"},"提示：未注册用户将会自动注册 ")])):w("",!0),g.isWechat?w("",!0):(i(),l("div",{key:1},[d("div",{class:"tw-flex tw-flex-row tw-border tw-border-solid tw-rounded-lg tw-border-2 tw-h-12 tw-items-center tw-px-2"},[d("div",{class:"tw-text-lg tw-flex tw-items-center tw-mr-2"},[d("img",{class:"tw-w-6 tw-h-6 tw-mr-1",src:"https://static.xxxxxx.com/mdi/e89ad9961a254e5848d6350655c94e34a36b080b296b2d5b1911a688ac40f96e"})]),d("div",{class:"tw-w-full tw-flex tw-items-center"},[n(y,{focus:"",class:"tw-w-full",modelValue:g.phone,"onUpdate:modelValue":e[1]||(e[1]=t=>g.phone=t),type:"number",placeholder:"请输入大陆手机号"},null,8,["modelValue"])])]),d("div",{class:"tw-mt-5"}),d("div",null,[n(v,{class:"tw-rounded-full",disabled:b.codeButtonDisabled,onClick:b.getCode},{default:a((()=>[d("div",{class:"tw-h-12 tw-flex tw-items-center tw-text-center tw-justify-center tw-text-md"},c(b.codeButtonText),1)])),_:1},8,["disabled","onClick"])]),d("div",{class:"tw-text-center tw-text-white tw-text-opacity-50 tw-mt-3 tw-text-sm"},"提示：未注册用户将会自动注册 ")]))])])])):w("",!0),b.isPage("code")?(i(),l("div",{key:1},[d("div",{class:"tw-px-5 tw-pt-2 tw-pb-16"},[d("div",{class:"tw-text-xl tw-flex tw-items-center"},[n(C,{onClick:e[2]||(e[2]=t=>b.switchPage("phone")),class:"tw-mr-2",size:"1rem",name:"jiantou-zuo"}),d("span",null,"输入验证码")]),d("div",{class:"tw-my-3"},[d("span",{class:"tw-opacity-60 tw-mr-1"},"验证码已经发送至"),d("span",{class:"tw-text-blue-500"},c(g.phone),1)]),d("div",{class:"tw-m-6"}),d("div",{class:"tw-flex tw-flex-row tw-border tw-border-solid tw-rounded-lg tw-border-2 tw-h-12 tw-items-center tw-px-2"},[d("div",{class:"tw-text-lg tw-flex tw-items-center tw-mr-2"},[d("img",{class:"tw-w-6 tw-h-6 tw-mr-1",src:"https://static.xxxxxx.com/mdi/4dfdd1527b4b307951f261b0d196f7d9c7d8b02e3ea4089d1be768e6be778013"})]),d("div",{class:"tw-w-full"},[n(y,{maxlength:"6",focus:"",class:"tw-w-full",modelValue:g.code,"onUpdate:modelValue":e[3]||(e[3]=t=>g.code=t),type:"number",placeholder:"请输入验证码"},null,8,["modelValue"])])]),d("div",{class:"tw-m-5"}),d("div",null,[n(v,{class:"tw-rounded-full",disabled:b.loginButtonDisabled,onClick:b.login},{default:a((()=>[d("div",{class:"tw-h-12 tw-flex tw-items-center tw-text-center tw-justify-center tw-text-md"}," 登录 ")])),_:1},8,["disabled","onClick"])])])])):w("",!0)])])),_:1},512)}]]);export{b as L};
